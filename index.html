<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™¾å®¶æ¨‚ç«æŸ´</title>
    <!-- å¼•å…¥ Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* ä½¿ç”¨ Noto Sans TC ä½œç‚ºé è¨­å­—é«” */
        body {
            font-family: 'Noto Sans TC', sans-serif;
            -webkit-tap-highlight-color: transparent; /* ç§»é™¤è¡Œå‹•è£ç½®é»æ“Šé«˜å…‰æ•ˆæœ */
        }

        /* æŒ‰éˆ•é»æ“Šæ™‚çš„è¦–è¦ºæ•ˆæœ */
        .divine-button:active {
            transform: scale(0.95);
            filter: brightness(0.9);
        }

        /* çµæœé¡¯ç¤ºçš„æ·¡å…¥å‹•ç•« */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }

        /* --- ç«æŸ´å‹•ç•«æ¨£å¼ --- */
        .matchstick {
            position: relative;
            width: 8px;
            height: 70px;
            background-color: #deb887; /* æœ¨è‰² (BurlyWood) */
            border-radius: 99px;
            transform-origin: center;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* åŠ å…¥è½åœ°å›å½ˆæ•ˆæœ */
        }
        .matchstick::before {
            content: '';
            position: absolute;
            top: -6px;
            left: 50%;
            transform: translateX(-50%);
            width: 16px;
            height: 16px;
            background-color: #b22222; /* ç«æŸ´é ­ç´…è‰² (FireBrick) */
            border-radius: 50%;
            transition: background-color 0.3s; /* åŠ å…¥é¡è‰²è®Šæ›éæ¸¡ */
        }
        
        /* æ–°å¢ï¼šä»£è¡¨ã€Œé™°ã€çš„æ¨£å¼ (ç‡’éçš„ç«æŸ´é ­) */
        .matchstick.yin::before {
            background-color: #4a5568; /* ç‡’éçš„ç°è‰² */
        }

        /* æ“²å‡ºå‹•ç•« */
        @keyframes toss {
            0% { transform: translateY(80px) rotate(0deg) scale(0.5); opacity: 0; }
            40% { transform: translateY(-50px) rotate(360deg) scale(1); opacity: 1; }
            70% { transform: translateY(10px) rotate(680deg); }
            100% { transform: translateY(0) rotate(720deg); opacity: 1; }
        }

        /* ç‚ºæ¯å€‹ç«æŸ´è¨­å®šä¸åŒçš„å»¶é² */
        .animate-toss .matchstick:nth-child(1) {
            animation: toss 1.3s cubic-bezier(0.25, 1, 0.5, 1) forwards;
        }
        .animate-toss .matchstick:nth-child(2) {
            animation: toss 1.3s cubic-bezier(0.25, 1, 0.5, 1) 0.1s forwards;
        }
        .animate-toss .matchstick:nth-child(3) {
            animation: toss 1.3s cubic-bezier(0.25, 1, 0.5, 1) 0.2s forwards;
        }
    </style>
</head>
<body class="bg-gray-900 text-white flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-md mx-auto bg-gray-800 rounded-2xl shadow-2xl p-6 md:p-8 text-center space-y-6">
        
        <!-- æ¨™é¡Œ -->
        <header>
            <h1 class="text-3xl md:text-4xl font-bold text-amber-400">ç™¾å®¶æ¨‚ç«æŸ´</h1>
        </header>

        <!-- å åœçµæœé¡¯ç¤ºå€åŸŸ -->
        <div id="result-container" class="bg-gray-900/50 rounded-lg p-6 min-h-[200px] flex flex-col items-center justify-center space-y-3 transition-all duration-300">
            <p id="placeholder" class="text-gray-500">ğŸš€æä»–ğŸš€</p>

            <!-- ç«æŸ´å‹•ç•«å®¹å™¨ (å›ºå®šé«˜åº¦) -->
            <div id="animation-container" class="hidden items-center justify-center space-x-6 h-[70px]">
                <div class="matchstick"></div>
                <div class="matchstick"></div>
                <div class="matchstick"></div>
            </div>
            
            <!-- å¦è±¡çµæœ (é è¨­éš±è—) -->
            <div id="divination-result" class="hidden flex-col items-center justify-center space-y-3">
                <!-- é€™è¡Œæ–‡å­—çµæœç¾åœ¨ç”±ç«æŸ´åœ–æ¡ˆå–ä»£ -->
                <div id="matches" class="hidden text-2xl font-mono tracking-widest"></div>
                <div id="trigram" class="text-4xl"></div>
                <div id="trigram-name" class="text-amber-300 text-lg"></div>
            </div>

            <!-- æŠ•æ³¨å»ºè­° (é è¨­éš±è—) -->
            <div id="suggestion" class="hidden text-3xl md:text-4xl font-bold tracking-wider"></div>
        </div>

        <!-- æŒ‰éˆ• -->
        <button id="divine-button" class="divine-button w-full bg-amber-500 hover:bg-amber-600 text-gray-900 text-xl font-bold py-4 px-6 rounded-xl shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-4 focus:ring-amber-400/50">
            é–‹å§‹å åœ
        </button>

        <!-- å…è²¬è²æ˜ -->
        <footer class="pt-4">
            <p class="text-xs text-gray-600">å…è²¬è²æ˜ï¼šæœ¬å·¥å…·åƒ…ä¾›å¨›æ¨‚ï¼Œçµæœä¸æ§‹æˆä»»ä½•æŠ•è³‡æˆ–æŠ•æ³¨å»ºè­°ã€‚è«‹å°è‡ªå·±çš„æ±ºå®šè² è²¬ï¼Œç†æ™ºåšå½©ã€‚</p>
        </footer>
    </div>

    <script>
        // DOM å…ƒç´ 
        const divineButton = document.getElementById('divine-button');
        const placeholder = document.getElementById('placeholder');
        
        const animationContainer = document.getElementById('animation-container');
        const matchstickElements = animationContainer.querySelectorAll('.matchstick');
        
        const divinationResult = document.getElementById('divination-result');
        const trigramEl = document.getElementById('trigram');
        const trigramNameEl = document.getElementById('trigram-name');
        
        const suggestionEl = document.getElementById('suggestion');

        // å®šç¾©å…«å¦åŠå…¶å°æ‡‰çš„æŠ•æ³¨å»ºè­°
        // 1 ä»£è¡¨ é™½ (ç´…é ­), 0 ä»£è¡¨ é™° (ç°é ­)
        const trigrams = {
            '111': { symbol: 'â˜°', name: 'ä¹¾ (å¤©)', suggestion: 'èŠ', color: 'text-red-400' },
            '000': { symbol: 'â˜·', name: 'å¤ (åœ°)', suggestion: 'é–’', color: 'text-blue-400' },
            '100': { symbol: 'â˜³', name: 'éœ‡ (é›·)', suggestion: 'èŠ', color: 'text-red-400' },
            '110': { symbol: 'â˜´', name: 'å·½ (é¢¨)', suggestion: 'é–’', color: 'text-blue-400' },
            '010': { symbol: 'â˜µ', name: 'å (æ°´)', suggestion: 'ä¼‘æ¯', color: 'text-gray-400' },
            '101': { symbol: 'â˜²', name: 'é›¢ (ç«)', suggestion: 'èŠ', color: 'text-red-400' },
            '001': { symbol: 'â˜¶', name: 'è‰® (å±±)', suggestion: 'ä¼‘æ¯', color: 'text-gray-400' },
            '011': { symbol: 'â˜±', name: 'å…Œ (æ¾¤)', suggestion: 'é–’', color: 'text-blue-400' },
        };

        // æŒ‰éˆ•é»æ“Šäº‹ä»¶
        divineButton.addEventListener('click', () => {
            // 1. ç¦ç”¨æŒ‰éˆ•ï¼Œé¡¯ç¤ºè¼‰å…¥ç‹€æ…‹
            divineButton.disabled = true;
            divineButton.textContent = 'å åœä¸­...';
            divineButton.classList.remove('bg-amber-500', 'hover:bg-amber-600');
            divineButton.classList.add('bg-gray-600', 'cursor-not-allowed');

            // 2. æ¸…é™¤ä¸Šæ¬¡çµæœ
            placeholder.classList.add('hidden');
            divinationResult.classList.add('hidden');
            suggestionEl.classList.add('hidden');
            suggestionEl.classList.remove('fade-in');
            divinationResult.classList.remove('fade-in');

            // é‡ç½®ç«æŸ´æ¨£å¼ï¼Œç‚ºæ–°å‹•ç•«åšæº–å‚™
            matchstickElements.forEach(stick => {
                stick.style.transform = '';
                stick.classList.remove('yin');
                stick.style.opacity = '0';
            });
            
            // é¡¯ç¤ºå‹•ç•«å®¹å™¨ä¸¦è§¸ç™¼å‹•ç•«
            animationContainer.classList.remove('hidden');
            animationContainer.classList.add('flex', 'animate-toss');

            // 3. æ¨¡æ“¬å åœéç¨‹ (å»¶é²1.5ç§’)
            setTimeout(() => {
                // æ¨¡æ“¬æ“²ä¸‰æç«æŸ´
                const matchResults = [
                    Math.round(Math.random()), 
                    Math.round(Math.random()), 
                    Math.round(Math.random())
                ];
                
                const key = matchResults.join('');
                const result = trigrams[key];

                // 4. ç§»é™¤å‹•ç•«classï¼Œä¸¦ç‚ºæ¯å€‹ç«æŸ´è¨­å®šæœ€çµ‚éš¨æ©Ÿç‹€æ…‹
                animationContainer.classList.remove('animate-toss');
                matchstickElements.forEach((stick, index) => {
                    const finalRotate = Math.random() * 360 - 180; // -180 to 180 åº¦
                    const finalX = Math.random() * 10 - 5;       // -5 to 5 px æ°´å¹³åç§»
                    const finalY = Math.random() * 10 - 5;       // -5 to 5 px å‚ç›´åç§»

                    stick.style.opacity = '1';
                    stick.style.transform = `translateX(${finalX}px) translateY(${finalY}px) rotate(${finalRotate}deg)`;

                    // æ ¹æ“šçµæœæ±ºå®šæ˜¯å¦ç‚ºã€Œé™°ã€(0)ï¼Œä¸¦æ”¹è®Šç«æŸ´é ­é¡è‰²
                    if (matchResults[index] === 0) {
                        stick.classList.add('yin');
                    }
                });

                // 5. é¡¯ç¤ºå¦è±¡åŠå»ºè­°
                trigramEl.textContent = result.symbol;
                trigramNameEl.textContent = result.name;
                suggestionEl.textContent = `å»ºè­°ï¼šæŠ• ${result.suggestion}`;
                suggestionEl.className = 'hidden text-3xl md:text-4xl font-bold tracking-wider';
                suggestionEl.classList.add(result.color);

                divinationResult.classList.remove('hidden');
                suggestionEl.classList.remove('hidden');
                divinationResult.classList.add('fade-in');
                suggestionEl.classList.add('fade-in');

                // 6. æ¢å¾©æŒ‰éˆ•ç‹€æ…‹
                divineButton.disabled = false;
                divineButton.textContent = 'å†æ¬¡å åœ';
                divineButton.classList.remove('bg-gray-600', 'cursor-not-allowed');
                divineButton.classList.add('bg-amber-500', 'hover:bg-amber-600');

            }, 1500); // å»¶é²æ™‚é–“éœ€å¤§è‡´é…åˆå‹•ç•«é•·åº¦
        });
    </script>
</body>
</html>

